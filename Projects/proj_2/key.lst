C51 COMPILER V9.01   KEY                                                                   05/18/2023 12:43:00 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN .\key.obj
COMPILER INVOKED BY: D:\C51\BIN\C51.EXE ..\..\App\key.c BROWSE INCDIR(..\..\App;..\..\Public) DEBUG OBJECTEXTEND PRINT(.
                    -\key.lst) OBJECT(.\key.obj)

line level    source

   1          //==头文件==
   2          #include <STC12C5A.h> // 51标准头文件
   3          #include "key.h"
   4          #include "led.h"
   5          #include "adda.h"
   6          //==========
   7          //==变量声明==
   8          unsigned char
   9                  amp_modi = 0,  // 调幅标志
  10                  da_index = 2,  // 调幅参数
  11                  flag_amp = 0,  // 显示幅值标志
  12                  flag_fre = 0,  // 显示频率标志 
  13                  fre_modi = 0,  // 调频标志
  14                  key_col = 0,   // 按键扫描当前列
  15                  key_num = 0,   // 按键序号
  16                  key_sta = 0,
  17                  mode = 0,          // 模式选择
  18                  wave_sel = 0;  // 信号发生器波形选择
  19          unsigned int
  20                  gen_count = 4; // 信号发生器频率控制
  21          
  22          //============
  23          void key_service()
  24          {
  25   1              if(key_sta & 0x01) return;//key_sta.0 = 1，按键为按下状态
  26   1              // key_sta.0 = 0，按键为弹起状态，检测到KEY1/KEY2行有按键被按下
  27   1              if(KEY1){
  28   2                      key_num = key_col + 1; 
  29   2                      key_sta = key_sta | 0x01;//key_sta.0 = 1
  30   2              }       
  31   1              else if(KEY2){
  32   2                      key_num = key_col + 5;
  33   2                      key_sta = key_sta | 0x01;//key_sta.0 = 1        
  34   2              }
  35   1              
  36   1      }
  37          void mode_select()      // 模式选择
  38          {
  39   1              switch(key_num){
  40   2                      case 1:{                // 模式1：实时采样+存储
  41   3                              mode = 1;
  42   3                              fdisp(1,0); // 数码管最左端显示模式1
  43   3                              fdisp(0,1);
  44   3                              fdisp(0,2);
  45   3                              fdisp(wave_sel,3);
  46   3                      };break;
  47   2                      case 2:{                // 模式2：波形回放10min波形
  48   3                              mode = 2;
  49   3                              fdisp(2,0);     // 数码管最左端显示模式2
  50   3                              fdisp(0,1);
  51   3                              fdisp(0,2);
  52   3                              fdisp(0,3);     // 数码管最右端波形显示清零     
  53   3                      };break;
  54   2                      case 3:{                // 模式3：停止显示
C51 COMPILER V9.01   KEY                                                                   05/18/2023 12:43:00 PAGE 2   

  55   3                              mode = 3;
  56   3                              fdisp(3,0);
  57   3                              fdisp(0,1);
  58   3                              fdisp(0,2);
  59   3                              fdisp(0,3);
  60   3                      };break;
  61   2                      
  62   2                      
  63   2                      default:break;
  64   2              }       
  65   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    131    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
